<!DOCTYPE html>
<html>

<head>

</head>

<body>
    <div>
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="javascript:loadMainPage();">หน้าหลัก</a>
            </li>
            <li class="breadcrumb-item active">ลงทะเบียนเรียน</li>
        </ol>
    </div>
    <br>
    <div class="label-header">ลงทะเบียนเรียน</div>
    <br>
    <div class="alert alert-dismissible alert-success" style="display: none;">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <strong>บันทึกข้อมูลสำเร็จ</strong>
    </div>
    <div class="alert alert-dismissible alert-danger" style="display: none;">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <strong>ไม่สามารถบันทึกข้อมูลได้</strong>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <div class="form-group" id="radioTutorSpec">
                    <div class="custom-control custom-radio">
                        <input type="radio" id="radioNonSpecificTutor" name="customRadio" class="custom-control-input" checked="">
                        <label class="custom-control-label labelnormal" for="radioNonSpecificTutor">ลงทะเบียนเรียนแบบไม่ระบุติวเตอร์</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input type="radio" id="radioSpecificTutor" name="customRadio" class="custom-control-input">
                        <label class="custom-control-label labelnormal" for="radioSpecificTutor">ลงทะเบียนเรียนแบบระบุติวเตอร์</label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br>
    <div id="divNonSpecificTutor">
        <ul class="nav nav-tabs">
            <li class="nav-item active">
                <a data-toggle="tab" href="#tabEditStudentInfo">1. ข้อมูลนักเรียน</a>
            </li>
            <li class="nav-item">
                <a data-toggle="tab" href="#tabEditRegisterClass">2. ข้อมูลวิชาเรียน</a>
            </li>
            <li class="nav-item">
                <a data-toggle="tab" href="#tabEditTutorSpec">3. ข้อมูลติวเตอร์</a>
            </li>
        </ul>
        <br>

        <div id="addNewClassTabContent" class="tab-content">
            <div class="tab-pane fade in active" id="tabEditStudentInfo">
                <br>
                <br>
                <form>
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12">
                                <form class="form-horizontal">
                                    <div class="form-group col-lg-12">
                                        <label for="dropdownStudentName" class="col-lg-3 labelform">ชื่อนักเรียน :</label>
                                        <div class="col-lg-4">
                                            <select class="form-control" id="dropdownStudentName">
                                            </select>
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required" id="divStudentFirstName">
                                        <label for="txtFirstName" class="col-lg-3 labelform">ชื่อ</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtStudentFirstName">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required" id="divStudentLastName">
                                        <label for="txtLastName" class="col-lg-3 labelform">นามสกุล</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtStudentLastName">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="txtNickname" class="col-lg-3">ชื่อเล่น</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtNickname">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="txtEmail" class="col-lg-3 labelform">อีเมล์</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtEmail">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="txtTel" class="col-lg-3 labelform">เบอร์โทรมือถือ</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtTel">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="dropdownSex" class="col-lg-3 labelform">เพศ</label>
                                        <div class="col-lg-4">
                                            <select class="custom-select" id="dropdownSex" required>
                                                <option value="M">ชาย</option>
                                                <option value="F">หญิง</option>
                                            </select>
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="dropdownLevel" class="col-lg-3 labelform">ระดับชั้น</label>
                                        <div class="col-lg-4">
                                            <select class="custom-select" id="dropdownLevel" required></select>
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="txtSchool" class="col-lg-3 labelform">สถานศึกษา</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtSchool">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div id="divStudentTime">
                        <div class="h2 inner-tab">วัน เวลาว่างและสถานที่เรียน</div>
                        <br>
                        <button id="btnAddStuTime" type="button" class="btn btn-primary container-btn-add-right" data-toggle="modal" data-target="#modalTimeDetail">
                            เพิ่ม
                        </button>

                        <table id="gridStuTime" class="table table-condensed table-hover table-striped scroll">
                            <thead>
                                <tr>
                                    <th data-column-id="id" data-identifier="true" data-type="numeric" data-width="5%">#</th>
                                    <th data-column-id="day" data-width="10%">วัน</th>
                                    <th data-column-id="startTime" data-width="15%">เวลาเริ่ม</th>
                                    <th data-column-id="endTime" data-width="15%">เวลาสิ้นสุด</th>
                                    <th data-column-id="location" data-width="45%">สถานที่เรียน</th>
                                    <th data-column-id="action" data-sortable="false" data-searchable="false" data-width="10%">Action</th>
                                </tr>
                            </thead>
                        </table>
                        <div class="modal fade" id="modalTimeDetail" tabindex="-1" role="dialog" aria-labelledby="modalTimeDetailLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="modalTimeDetailLabel">เพิ่มวัน เวลา สถานที่เรียน</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <form>
                                            <div class="form-group required" id="divMultipleDay">
                                                <label for="dropdownMultipleDay" class="labelform">วันเรียน</label>
                                                <select multiple="" class="custom-select" id="dropdownMultipleDay">
                                                </select>
                                            </div>

                                            <div class="form-group required" id="divTxtDayOfTutor">
                                                <label for="txtDay" class="labelform">วันเรียน</label>
                                                <input type="text" class="form-control" id="txtDay" readonly>
                                            </div>
                                            <!--
                                            <div class="form-group required" id='groupCopyFromDay'>
                                                <label for="dropdownCopyFromDay" class="labelform">สำเนาจาก</label>
                                                <select class="custom-select" id="dropdownCopyFromDay">
                                                </select>
                                            </div>
                                            <div class="form-group required">
                                                <label for="dropdownDay" class="labelform">วัน</label>
                                                <select class="custom-select" id="dropdownDay">
                                                </select>
                                            </div>
                                            -->
                                            <div class="form-group required">
                                                <label for="dropdownStartTime" class="labelform">เวลาเริ่มต้น</label>
                                                <select class="custom-select" id="dropdownStartTime">
                                                </select>
                                            </div>
                                            <div class="form-group required">
                                                <label for="dropdownEndTime" class="labelform">เวลาสิ้นสุด</label>
                                                <select class="custom-select" id="dropdownEndTime">
                                                </select>
                                            </div>
                                            <div class="form-group required">
                                                <label for="txtPlace" class="labelform">สถานที่เรียน</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" id="txtPlace" readonly>
                                                    <button id="btnStudentGoogleMap" type="button" class="btn btn-secondary input-group-btn btn-google-pin" data-toggle="modal"
                                                        data-target="#modalStudentGoogleMap">
                                                        <div class="img-google-pin"></div>
                                                    </button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-primary" id="btnSaveAddTime">ตกลง</button>
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br>
                        <br>
                        <br>
                        <!-- Modal Add Google map-->
                        <div class="modal fade" id="modalStudentGoogleMap" tabindex="-1" role="dialog" aria-labelledby="modalStudentGoogleMapLabel"
                            aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content contentmap">
                                    <div class="modal-body mapbody">
                                        <div style="display:block">
                                            <input id="pac-input" class="controls" type="text" placeholder="Enter a location">
                                        </div>
                                        <div id="map" class="map"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br>

                    </div>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                </form>
            </div>
            <div class="tab-pane fade" id="tabEditRegisterClass">
                <!-- Button trigger modal -->
                <button id="btnAddNewClass" type="button" class="btn btn-primary container-btn-add-right" data-toggle="modal" data-target="#modalAddRegisterClass">
                    เพิ่ม
                </button>

                <table id="gridEditClass" class="table table-condensed table-hover table-striped scroll">
                    <thead>
                        <tr>
                            <th data-column-id="id" data-identifier="true" data-type="numeric" data-width="3%">#</th>
                            <th data-column-id="class" data-width="10%">วิชา</th>
                            <th data-column-id="level" data-width="15%">ระดับชั้น</th>
                            <th data-column-id="numStu" data-width="10%">จำนวนนักเรียน</th>
                            <th data-column-id="numDay" data-width="13%">จำนวนวันเรียน/สัปดาห์</th>
                            <th data-column-id="hoursPerDay" data-width="13%">จำนวนชั่วโมงเรียน/ครั้ง</th>
                            <th data-column-id="totalHours" data-width="17%">จำนวนชั่วโมงเรียนโดยประมาณ</th>
                            <th data-column-id="pricePerson" data-width="11%">ราคา/ชั่วโมง/คน</th>
                            <th data-column-id="action" data-sortable="false" data-searchable="false" data-width="8%">Action</th>
                        </tr>
                    </thead>
                </table>

                <!-- Modal Add Class-->
                <div class="modal fade" id="modalAddRegisterClass" tabindex="-1" role="dialog" aria-labelledby="modalAddRegisterClass" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="modalAddSubjectClassLabel">เพิ่มวิชา</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="form-group">
                                        <label for="dropdownSubject">วิชา</label>
                                        <select class="form-control" id="dropdownSubject">
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="dropdownClass">ระดับชั้น</label>
                                        <select class="form-control" id="dropdownClass">
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="dropdownNumStu">จำนวนผู้เรียน</label>
                                        <select class="form-control" id="dropdownNumStu">
                                            <option selected value="1">1 คน</option>
                                            <option value="2">2 คน</option>
                                            <option value="3">3 คน</option>
                                            <option value="4">4 คนขึ้นไป</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="dropdownNumDayPerWeek">จำนวนวันเรียนต่อสัปดาห์</label>
                                        <select class="form-control" id="dropdownNumDayPerWeek">
                                            <option selected value="1">1 วัน</option>
                                            <option value="2">2 วัน</option>
                                            <option value="3">3 วัน</option>
                                            <option value="4">4 วัน</option>
                                            <option value="5">5 วัน</option>
                                            <option value="6">6 วัน</option>
                                            <option value="3">7 วัน</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="dropdownHours">จำนวนชั่วโมงเรียนต่อครั้ง</label>
                                        <select class="form-control" id="dropdownHours">
                                            <option selected value="2">2 ชั่วโมง</option>
                                            <option value="3">3 ชั่วโมง</option>
                                            <option value="4">4 ชั่วโมง</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="dropdownTotalHours">จำนวนชั่วโมงเรียนโดยประมาณ</label>
                                        <select class="form-control" id="dropdownTotalHours">
                                            <option selected value="15">15 ชั่วโมง</option>
                                            <option value="20">20 ชั่วโมง</option>
                                            <option value="30">มากกว่าหรือเท่ากับ 30 ชั่วโมง</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="txtPrice">ราคาต่อชั่วโมงต่อคน</label>
                                        <input type="text" class="form-control" id="txtPrice" readonly>
                                        </select>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" id="btnSaveSubject">ตกลง</button>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div>** หากเรียนมากกว่า 1 วิชาและต้องการระบุหลักสูตรหรือคุณสมบัติติวเตอร์แตกต่างกัน กรุณาเลือกเมนู "สมัครเรียนเพิ่มเติม"
                    หลังจากที่สมัครเรียนแล้ว
                </div>
                <br>
                <form>
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12">
                                <form class="form-horizontal">
                                    <div class="form-group required">
                                        <label class="col-lg-1 labelform">ลักษณะการเรียน :</label>
                                        <div class="col-lg-11">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios1" value="1" checked>
                                                <label class="form-check-label" for="gridRadios1">
                                                    เรียนและใช้เอกสารประกอบการเรียนเป็นภาษาไทย
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios2" value="2">
                                                <label class="form-check-label" for="gridRadios2">
                                                    เรียนเป็นภาษาไทย และใช้เอกสารประกอบการเรียนเป็นภาษาอังกฤษ
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios3" value="3">
                                                <label class="form-check-label" for="gridRadios3">
                                                    เรียนและใช้เอกสารประกอบการเรียนเป็นภาษาอังกฤษ
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <br>
                    <br>
                    <br>
                </form>
            </div>
            <div class="tab-pane fade" id="tabEditTutorSpec">
                <br>
                <div class="label-header">ข้อมูลติวเตอร์</div>
                <br>
                <form>
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12">
                                <form class="form-horizontal">
                                    <div class="form-group col-lg-12">
                                        <label for="dropdownTutorSex" class="col-lg-2">เพศของติวเตอร์ :</label>
                                        <select class="form-control col-lg-5" id="dropdownTutorSex">
                                            <option selected value="null">ไม่ระบุ</option>
                                            <option value="M">ชาย</option>
                                            <option value="F">หญิง</option>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12" style="margin-bottom:1px;">
                                        <label class="col-lg-2"></label>
                                        <div class="col-lg-5" style="display: inline-block;text-align:right;width: 100%;">
                                            <button type="button" id="selectalluni" class="btn btn-secondary  btn-sm">Select All</button>
                                            <button type="button" id="deselectalluni" class="btn btn-secondary  btn-sm">Deselect All</button>
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12" for="chkTutorUni">
                                        <label class="col-lg-2">สถาบันของติวเตอร์ :</label>
                                        <div id="chkTutorUni" class="col-lg-5 box-scroll"></div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12" style="margin-bottom:1px;">
                                        <label class="col-lg-2"></label>
                                        <div class="col-lg-5" style="display: inline-block;text-align:right;width: 100%;">
                                            <button type="button" id="selectallfac" class="btn btn-secondary  btn-sm">Select All</button>
                                            <button type="button" id="deselectallfac" class="btn btn-secondary  btn-sm">Deselect All</button>
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12" for="chkTutorFac">
                                        <label class="col-lg-2">คณะของติวเตอร์ :</label>
                                        <div id="chkTutorFac" class="col-lg-5 box-scroll"></div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <input type="checkbox" id="chkExp">&nbsp&nbspต้องการติวเตอร์มีประสบการณ์</input>
                                    </div>
                            </div>
                            </form>
                        </div>
                    </div>
                    <div class="h2 inner-tab" style="margin: 20px;">ลำดับปัจจัยที่ใช้ในการคัดเลือกติวเตอร์</div>
                    <div class="container-fluid">
                        <div class="row">
                            <div class="form-group col-lg-12">
                                <div class="col-lg-7">
                                    <table class="table table-bordered pagin-table dragorder">
                                        <thead>
                                            <tr>
                                                <th width="50px">#</th>
                                                <th>ปัจจัย</th>
                                            </tr>
                                        </thead>
                                        <tbody id="sort-table" class="dragorder">
                                            <tr>
                                                <td>1</td>
                                                <td>เพศของติวเตอร์</td>
                                            </tr>
                                            <tr>
                                                <td>2</td>
                                                <td>คณะและสถาบันของติวเตอร์</td>
                                            </tr>
                                            <tr>
                                                <td>4</td>
                                                <td>ประสบการณ์ของติวเตอร์</td>
                                            </tr>
                                            <tr>
                                                <td>5</td>
                                                <td>ผลประเมินงานสอนของติวเตอร์</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-lg-4"></div>
                        <div class="col-lg-4">
                            <button type="button" class="btn btn-primary btn-lg" id="btnCreateClassNoSpecific">บันทึก</button>
                            <button type="button" class="btn btn-secondary btn-lg" href="javascript:loadMainPage();">ยกเลิก</button>
                        </div>
                        <div class="col-lg-4"></div>
                    </div>
            </div>
        </div>
        </form>
        </form>
    </div>
    </div>
    </div>
    <div id="divSpecificTutor">
        <ul class="nav nav-tabs">
            <li class="nav-item active">
                <a data-toggle="tab" href="#tabEditStudentInfoSpec">1. ข้อมูลนักเรียน</a>
            </li>
            <li class="nav-item">
                <a data-toggle="tab" href="#tabEditRegisterClassSpec">2. ข้อมูลการลงทะเบียนเรียน</a>
            </li>
        </ul>
        <div id="addNewClassTabContentSpec" class="tab-content">
            <div class="tab-pane fade in active" id="tabEditStudentInfoSpec">
                <br>
                <br>
                <form>
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12">
                                <form class="form-horizontal">
                                    <div class="form-group col-lg-12">
                                        <label for="dropdownStudentNameSpec" class="col-lg-3 labelform">ชื่อนักเรียน :</label>
                                        <div class="col-lg-4">
                                            <select class="form-control" id="dropdownStudentNameSpec">
                                            </select>
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required" id="divStudentFirstNameSpec">
                                        <label for="txtFirstNameSpec" class="col-lg-3 labelform">ชื่อ</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtFirstNameSpec">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required" id="divStudentLastNameSpec">
                                        <label for="txtLastNameSpec" class="col-lg-3 labelform">นามสกุล</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtLastNameSpec">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="txtNicknameSpec" class="col-lg-3">ชื่อเล่น</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtNicknameSpec">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="txtEmailSpec" class="col-lg-3 labelform">อีเมล์</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtEmailSpec">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="txtTelSpec" class="col-lg-3 labelform">เบอร์โทรมือถือ</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtTelSpec">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="dropdownSexSpec" class="col-lg-3 labelform">เพศ</label>
                                        <div class="col-lg-4">
                                            <select class="custom-select" id="dropdownSexSpec" required>
                                                <option value="M">ชาย</option>
                                                <option value="F">หญิง</option>
                                            </select>
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="dropdownLevelSpec" class="col-lg-3 labelform">ระดับชั้น</label>
                                        <div class="col-lg-4">
                                            <select class="custom-select" id="dropdownLevelSpec" required></select>
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12 required">
                                        <label for="txtSchoolSpec" class="col-lg-3 labelform">สถานศึกษา</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id="txtSchoolSpec">
                                        </div>
                                        <div class="col-lg-5"></div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                </form>
            </div>

            <div class="tab-pane fade" id="tabEditRegisterClassSpec">
                <br>
                <br>
                <form>
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12">
                                <form class="form-horizontal">
                                    <div class="form-group col-lg-12">
                                        <label for="dropdownSpecSubject" class="col-lg-3">ชื่อวิชา :</label>
                                        <select class="form-control col-lg-4" id="dropdownSpecSubject">
                                            <option selected value="null">ไม่ระบุ</option>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="dropdownSpecLevel" class="col-lg-3">ระดับชั้น:</label>
                                        <select class="form-control col-lg-4" id="dropdownSpecLevel">
                                            <option selected value="null">ไม่ระบุ</option>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="dropdownNumStu" class="col-lg-3">จำนวนผู้เรียน:</label>
                                        <select class="form-control col-lg-4" id="dropdownSpecNumStu">
                                            <option selected value="1">1 คน</option>
                                            <option value="2">2 คน</option>
                                            <option value="3">3 คน</option>
                                            <option value="4">4 คนขึ้นไป</option>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="dropdownTotalHours" class="col-lg-3">จำนวนชั่วโมงเรียนโดยประมาณ:</label>
                                        <select class="form-control col-lg-4" id="dropdownSpecTotalHours">
                                            <option selected value="15">15 ชั่วโมง</option>
                                            <option value="20">20 ชั่วโมง</option>
                                            <option value="30">มากกว่าหรือเท่ากับ 30 ชั่วโมง</option>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="txtSpecPrice" class="col-lg-3">ราคาต่อชั่วโมงต่อคน:</label>
                                        <input type="text" class="form-control col-lg-4" id="txtSpecPrice" readonly>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label class="col-lg-3 labelform">หลักสูตร :</label>
                                        <div class="col-lg-9">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioProgs" id="radioProg1" value="1" checked>
                                                <label class="form-check-label" for="radioProg1">
                                                    เรียนและใช้เอกสารประกอบการเรียนเป็นภาษาไทย
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioProgs" id="radioProg2" value="2">
                                                <label class="form-check-label" for="radioProg2">
                                                    เรียนเป็นภาษาไทย และใช้เอกสารประกอบการเรียนเป็นภาษาอังกฤษ
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioProgs" id="radioProg3" value="3">
                                                <label class="form-check-label" for="radioProg3">
                                                    เรียนและใช้เอกสารประกอบการเรียนเป็นภาษาอังกฤษ
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="h2 inner-tab" style="margin: 20px;">ข้อมูลติวเตอร์</div>
                                    <div class="form-group col-lg-12">
                                        <label for="dropdownSpecTutor" class="col-lg-3">ชื่อติวเตอร์ :</label>
                                        <select class="form-control col-lg-4" id="dropdownSpecTutor">
                                            <option selected value="null">ไม่ระบุ</option>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="txtSpecTurSex" class="col-lg-3">เพศ</label>
                                        <input type="text" class="form-control col-lg-4" id="txtSpecTurSex" readonly>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="txtSpecTurFac" class="col-lg-3">คณะ</label>
                                        <input type="text" class="form-control col-lg-4" id="txtSpecTurFac" readonly>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="txtSpecTurUni" class="col-lg-3">สถาบัน</label>
                                        <input type="text" class="form-control col-lg-4" id="txtSpecTurUni" readonly>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="txtSpecTurExp" class="col-lg-3">ประสบการณ์สอน</label>
                                        <input type="text" class="form-control col-lg-4" id="txtSpecTurExp" readonly>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="txtSpecTurClip" class="col-lg-3">ตัวอย่างคลิปงานสอน</label>
                                        <input type="text" class="form-control col-lg-4" id="txtSpecTurClip" readonly>
                                        </select>
                                        <div class="col-lg-5"></div>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12">
                                <table id="gridSpecTutorAva" class="table table-condensed table-hover table-striped scroll">
                                    <thead>
                                        <tr>
                                            <th data-column-id="id" data-width="5%" data-identifier="true" data-type="numeric">#</th>
                                            <th data-column-id="day" data-width="10%">วัน</th>
                                            <th data-column-id="time" data-width="15%">เวลาว่าง</th>
                                            <th data-column-id="startPlace" data-width="30%">สถานที่เริ่มต้นเดินทาง</th>
                                            <th data-column-id="endPlace" data-width="30%">สถานที่สุดท้ายของวัน</th>
                                        </tr>
                                    </thead>
                                </table>
                                <div class="h2 inner-tab" style="margin-right: 20px;">วัน เวลาและสถานที่เรียน</div>
                                <!-- Button trigger modal -->
                                <button id="btnAddStudentAva" type="button" class="btn btn-primary container-btn-add-right" data-toggle="modal" data-target="#modalStuAva"
                                    onclick="javascript:addStudentSpecTime();">
                                    เพิ่ม
                                </button>
                                <br>
                                <table id="gridStudentAva" class="table table-condensed table-hover table-striped scroll">
                                    <thead>
                                        <tr>
                                            <th data-column-id="id" data-width="5%" data-identifier="true" data-type="numeric">#</th>
                                            <th data-column-id="day" data-width="10%">วัน</th>
                                            <th data-column-id="startTime" data-width="15%">เวลาเริ่มเรียน</th>
                                            <th data-column-id="endTime" data-width="15%">เวลาเลิกเรียน</th>
                                            <th data-column-id="location" data-width="45%">สถานที่เรียน</th>
                                            <th data-column-id="action" data-width="10%">Action</th>
                                        </tr>
                                    </thead>
                                </table>

                            </div>
                        </div>
                    </div>
                    <!-- Modal Student Time Management -->
                    <div class="modal fade" id="modalStuAva" tabindex="-1" role="dialog" aria-labelledby="modalStuAvaLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalStuAvaLabel">เพิ่มวัน เวลา สถานที่เรียน</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form>
                                        <div class="form-group required" id="divDropdownDayOfTutorSpec">
                                            <label for="dropDownDayOfTutorSpec" class="labelform">วันเรียน</label>
                                            <select multiple="" class="custom-select" id="dropdownDayOfTutorSpec">
                                            </select>
                                        </div>
                                        <div class="form-group required" id="divTxtDayOfTutorSpec">
                                            <label for="txtSpecDay" class="labelform">วันเรียน</label>
                                            <input type="text" class="form-control" id="txtSpecDay" readonly>
                                        </div>
                                        <div class="form-group required">
                                            <label for="dropdownSpecStartTime" class="labelform">เวลาเริ่มต้น</label>
                                            <select class="custom-select" id="dropdownSpecStartTime">
                                            </select>
                                        </div>
                                        <div class="form-group required">
                                            <label for="dropdownSpecEndTime" class="labelform">เวลาสิ้นสุด</label>
                                            <select class="custom-select" id="dropdownSpecEndTime">
                                            </select>
                                        </div>
                                        <div class="form-group required">
                                            <label for="txtStudyPlace" class="labelform">สถานที่เรียน</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="txtStudyPlace" readonly>
                                                <button id="btnSpecStudentGoogleMap" type="button" class="btn btn-secondary input-group-btn btn-google-pin" data-toggle="modal"
                                                    data-target="#modalSpecStudentGoogleMap">
                                                    <div class="img-google-pin"></div>
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary" id="btnSpecSaveAddTime" onclick="javascript:addStudentTimeSpec();" value="-1">ตกลง</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Modal Add Google map-->
                    <div class="modal fade" id="modalSpecStudentGoogleMap" tabindex="-1" role="dialog" aria-labelledby="modalSpecStudentGoogleMapLabel"
                        aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content contentmap">
                                <div class="modal-body mapbody">
                                    <div style="display:block">
                                        <input id="spec-pac-input" class="controls pac-input" style="width: 600px;" type="text" placeholder="Enter a location">
                                    </div>
                                    <div id="spec-map" class="map"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="form-group">
                        <div class="col-lg-4"></div>
                        <div class="col-lg-4">
                            <button type="button" class="btn btn-primary btn-lg" id="btnCreateClassSpecific">บันทึก</button>
                            <button type="button" class="btn btn-secondary btn-lg" href="javascript:loadMainPage();">ยกเลิก</button>
                        </div>
                        <div class="col-lg-4"></div>
                    </div>
                </form>
            </div>
        </div>
</body>
<script>
    _isInitGmapStartAndEndPlace = false;
    _isInitGmapStartAndEndPlaceSpec = false;
    var marker = null;
    var specmarker = null;
    var universities = [];
    var faculties = [];
    var subjects = [];
    var childcatagories = [];
    var applySubjects = [];
    var stuavatimes = [];
    var stuSpecAvatimes = [];
    var _gStudents;
    $('#sort-table').sortable();

    for (var i = 0; i < dataTime.length; i++) {
        $('#dropdownStartTime').append('<option value="' + dataTime[i].val + '">' + dataTime[i].name + '</option>');
        $('#dropdownEndTime').append('<option value="' + dataTime[i].val + '">' + dataTime[i].name + '</option>');
    }


    $(document).ready(function () {
        //    appendApplySubjectList(null, 0);
        $('#sort-table td:nth-child(1),th:nth-child(1)').hide();
        initialUniList();
        initialFacList();
        initialSubjectDetailList();
        initialStudentNameList();

        if ($('#radioNonSpecificTutor').is(':checked')) {
            console.log("radioNonSpecificTutor");
            $('#divNonSpecificTutor').show();
            $('#divSpecificTutor').hide();
        }
        if ($('#radioSpecificTutor').is(':checked')) {
            console.log("radioSpecificTutor");
            $('#divNonSpecificTutor').hide();
            $('#divSpecificTutor').show();
        }

    });

    $('#radioTutorSpec').click(function () {
        console.log("on radio click");
        if ($('#radioNonSpecificTutor').is(':checked')) {
            console.log("radioNonSpecificTutor");
            $('#divNonSpecificTutor').show();
            $('#divSpecificTutor').hide();
        }
        if ($('#radioSpecificTutor').is(':checked')) {
            console.log("radioSpecificTutor");
            $('#divNonSpecificTutor').hide();
            $('#divSpecificTutor').show();
        }
    });


    /* --- Non Specific Tutor ----*/
    var gridEditClass = $("#gridEditClass").bootgrid({
        navigation: 0,
        labels: {
            noResults: 'ไม่พบรายการ'
        }
    }).on("loaded.rs.jquery.bootgrid", function () {
        gridEditClass.find(".command-edit").on("click", function (e) {
            var i = parseInt($(this).data("row-id"));
            initialEditPopup(i);
        }).end().find(".command-delete").on("click", function (e) {
            var i = parseInt($(this).data("row-id"));
            var subjectBySubjid = subjects.filter(function (el) {
                return el.subjId == applySubjects[i].subjId;
            });
            var subjName = "";
            if (subjectBySubjid[0]) {
                subjName = subjectBySubjid[0].subject.subjName;
            }
            var catBySubcid = childcatagories.filter(function (el) {
                return el.subcId == applySubjects[i].subcId;
            });
            var subcName = "";
            if (catBySubcid[0]) {
                subcName = catBySubcid[0].subcName;
            }

            var result = confirm("ต้องการลบรายการ " + subjName + " " + subcName + " ใช่หรือไม่?");
            if (result) {
                applySubjects.splice(i, 1);
                reloadlist();
            }
        });
    });

    function initialUniList() {
        console.log("initial university");
        universities = [];
        $.ajax({
            type: "GET",
            url: _gServiceURL + "university/list",
            contentType: "application/json; charset=utf-8",
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                console.log(data.data.universities);
                universities = data.data.universities;
                for (var i = 0; i < universities.length; i++) {
                    $('#chkTutorUni').append('<label><input type="checkbox" name="' + universities[i].uniId + '" id="chkTutorUni' + i + '" checked>&nbsp&nbsp' + universities[i].uniName + '</label><br>');
                }
            },
            error: function (jqXHR, status) {
                console.log(jqXHR);
                alert('fail' + status.code);
            }
        });
    }

    function initialFacList() {
        console.log("initial faculty");
        faculties = [];
        $.ajax({
            type: "GET",
            url: _gServiceURL + "faculty/list",
            contentType: "application/json; charset=utf-8",
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                console.log(data.data.faculties);
                faculties = data.data.faculties;
                for (var i = 0; i < faculties.length; i++) {
                    $('#chkTutorFac').append('<label><input type="checkbox" name="' + faculties[i].facId + '" id="chkTutorFac' + i + '" checked>&nbsp&nbsp' + faculties[i].facName + '</label><br>');
                }
            },
            error: function (jqXHR, status) {
                console.log(jqXHR);
                alert('fail' + status.code);
            }
        });
    }

    function initialSubjectDetailList() {
        console.log("initial subject detail");
        subjects = [];
        $.ajax({
            type: "GET",
            url: _gServiceURL + "subjectdetail/listforclass",
            contentType: "application/json; charset=utf-8",
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                console.log(data.data.subjectDetailForApplyJobViews);
                subjects = data.data.subjectDetailForApplyJobViews;
                for (var i = 0; i < subjects.length; i++) {
                    $('#dropdownSubject').append('<option value="' + subjects[i].subjId + '">' + subjects[i].subject.subjName + '</option>');
                }
                for (var i = 0; i < subjects.length; i++) {
                    $('#dropdownSpecSubject').append('<option value="' + subjects[i].subjId + '">' + subjects[i].subject.subjName + '</option>');
                }
                if (subjects.length > 0) {
                    childcatagories = subjects[0].subjectCatagories;
                    for (var i = 0; i < childcatagories.length; i++) {
                        $('#dropdownClass').append('<option value="' + childcatagories[i].subcId + '">' + childcatagories[i].subcName + '</option>');
                    }
                    for (var i = 0; i < childcatagories.length; i++) {
                        $('#dropdownSpecLevel').append('<option value="' + childcatagories[i].subcId + '">' + childcatagories[i].subcName + '</option>');
                    }
                }
            },
            error: function (jqXHR, status) {
                console.log(jqXHR);
                alert('fail' + status.code);
            }
        });
    }

    function initialStudentNameList() {
        console.log("initial student name");
        _gStudents = [];
        $.ajax({
            type: "GET",
            url: _gServiceURL + "parent/studentlist/" + _gUser.parId,
            contentType: "application/json; charset=utf-8",
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                console.log(data.data.students);
                _gStudents = data.data.students;
                for (var i = 0; i < _gStudents.length; i++) {
                    $('#dropdownStudentNameSpec').append('<option value="' + _gStudents[i].stuId + '">' + _gStudents[i].stuFirstname + " " + _gStudents[i].stuLastname + '</option>');
                    $('#dropdownStudentName').append('<option value="' + _gStudents[i].stuId + '">' + _gStudents[i].stuFirstname + " " + _gStudents[i].stuLastname + '</option>');
                }


            },
            error: function (jqXHR, status) {
                console.log(jqXHR);
                alert('fail' + status.code);
            }
        });
    }


    $("#btnSaveSubject").on("click", function (e) {
        var i = $(this).val();
        var subjId = parseInt($('#dropdownSubject option:selected').val());
        var subcId = parseInt($('#dropdownClass option:selected').val());
        var numStu = parseInt($('#dropdownNumStu option:selected').val());
        var dayPerWeek = parseInt($('#dropdownNumDayPerWeek option:selected').val());
        var hours = parseInt($('#dropdownHours option:selected').val());
        var totalhours = parseInt($('#dropdownTotalHours option:selected').val());
        var price = $('#txtPrice').val();
        var applySubject = {
            subjId: subjId,
            subcId: subcId,
            numStu: numStu,
            dayPerWeek: dayPerWeek,
            hours: hours,
            totalhours: totalhours,
            price: price
        }
        if (i == -1) {
            applySubjects.push(applySubject);
        } else {
            applySubjects[i] = applySubject;
        }
        reloadlist();
        $('#modalAddRegisterClass').modal('hide');
    });

    function reloadlist() {
        gridEditClass.bootgrid('clear');
        for (var j = 0; j < applySubjects.length; j++) {
            console.log("data : " + applySubjects[j]);
            appendApplyAddSubjectList(applySubjects[j], j);
        }
    }


    function initialEditPopup(i) {
        $("#btnSaveSubject").val(i);
        $('#modalAddSubjectClassLabel').text("แก้ไขวิชา");
        $('#dropdownSubject').val(applySubjects[i].subjId);
        $('#dropdownClass').val(applySubjects[i].subcId);
        $('#dropdownNumStu ').val(applySubjects[i].numStu);
        $('#dropdownNumDayPerWeek').val(applySubjects[i].dayPerWeek);
        $('#dropdownHours').val(applySubjects[i].hours);
        $('#dropdownTotalHours').val(applySubjects[i].totalhours);
        $('#txtPrice').val(applySubjects[i].price);
        $('#modalAddRegisterClass').modal('show');
    }

    function initialAddPopup() {
        $('#modalAddSubjectClassLabel').text("เพิ่มวิชา");
        $("#btnSaveSubject").val(-1);
        $("#dropdownSubject").val($("#dropdownSubject option:first").val());
        $("#dropdownClass").val($("#dropdownClass option:first").val());
        $("#dropdownNumStu").val($("#dropdownNumStu option:first").val());
        $('#dropdownNumDayPerWeek').val($('#dropdownNumDayPerWeek option:first').val());
        $('#dropdownHours').val($('#dropdownHours option:first').val());
        $('#dropdownTotalHours').val($('#dropdownTotalHours option:first').val());
        getPrice();
    }

    function appendApplyAddSubjectList(applySubject, i) {
        console.log(applySubject);
        var subjectBySubjid = subjects.filter(function (el) {
            return el.subjId == applySubject.subjId;
        });
        var subjName = "";
        if (subjectBySubjid[0]) {
            subjName = subjectBySubjid[0].subject.subjName;
        }
        var catBySubcid = childcatagories.filter(function (el) {
            return el.subcId == applySubject.subcId;
        });
        var subcName = "";
        if (catBySubcid[0]) {
            subcName = catBySubcid[0].subcName;
        }

        gridEditClass.bootgrid("append", [
            {
                "id": i + 1,
                "class": subjName,
                "level": subcName,
                "numStu": applySubject.numStu,
                "numDay": applySubject.dayPerWeek,
                "hoursPerDay": applySubject.hours,
                "totalHours": applySubject.totalhours,
                "pricePerson": applySubject.price,
                "action": "<button id='editSubjectClassBtn' type='button' class='btn btn-xs btn-default command-edit' data-row-id='" + i + "'><div class='fa-pencil'></div></button> "
                    + "<button id='deleteSubjectClassBtn' type='button' class='btn btn-xs btn-default command-delete' data-row-id='" + i + "'><div class='fa-trash-o'></div></button>"
            }
        ]);
    }


    $("#dropdownSubject").change(function () {
        $('#dropdownClass').empty();
        var subjId = this.value;
        var subjectBySubjid = subjects.filter(function (el) {
            return el.subjId == subjId;
        });
        console.log(subjectBySubjid);

        if (subjectBySubjid[0]) {
            var subjectCatagories = subjectBySubjid[0].subjectCatagories;
            console.log(subjectCatagories);
            for (var i = 0; i < subjectCatagories.length; i++) {
                $('#dropdownClass').append('<option value="' + subjectCatagories[i].subcId + '">' + subjectCatagories[i].subcName + '</option>');
            }
        }
    });

    $("#dropdownClass").change(function () {
        getPrice();
    });

    $("#dropdownNumStu").change(function () {
        getPrice();
    });

    $("#btnAddNewClass").on("click", function (e) {
        initialAddPopup();
    });
    /*
    $("#editSubjectClassBtn").on("click", function (e) {
        getPrice();
    });*/

    function getPrice() {
        var subjId = parseInt($('#dropdownSubject option:selected').val());
        var subcId = parseInt($('#dropdownClass option:selected').val());
        var numStu = parseInt($('#dropdownNumStu option:selected').val());
        console.log(_gServiceURL + "subjectprice/getprice/" + subjId + "/" + subcId + "/" + numStu);
        $.ajax({
            type: "GET",
            url: _gServiceURL + "subjectprice/getprice/" + subjId + "/" + subcId + "/" + numStu,
            contentType: "application/json; charset=utf-8",
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                console.log(data.data);
                var subjectPrice = data.data.subjectPrice;
                $('#txtPrice').val(subjectPrice.sprPrice);
            },
            error: function (jqXHR, status) {
                console.log(jqXHR);
                alert('fail' + status.code);
            }
        });
    }

    $("#selectalluni").on("click", function (e) {
        $("#chkTutorUni").find("input[type='checkbox']").each(function () {
            $(this).prop('checked', true);
        });
    });
    $("#selectallfac").on("click", function (e) {
        $("#chkTutorFac").find("input[type='checkbox']").each(function () {
            $(this).prop('checked', true);
        });
    });
    $("#deselectalluni").on("click", function (e) {
        $("#chkTutorUni").find("input[type='checkbox']").each(function () {
            $(this).prop('checked', false);
        });
    });
    $("#deselectallfac").on("click", function (e) {
        $("#chkTutorFac").find("input[type='checkbox']").each(function () {
            $(this).prop('checked', false);
        });
    });

    // Student Ava Times

    var gridStuTime = $("#gridStuTime").bootgrid({
        navigation: 0,
        labels: {
            noResults: 'ไม่พบรายการ'
        }
    }).on("loaded.rs.jquery.bootgrid", function () {
        gridStuTime.find(".command-edit").on("click", function (e) {
            var i = parseInt($(this).data("row-id"));
            edittime(i);
        }).end().find(".command-delete").on("click", function (e) {
            var i = parseInt($(this).data("row-id"));
            var dayName = dataDay[stuavatimes[i].savDayId - 1].name;
            var result = confirm("ต้องการลบรายการ " + dayName + " ใช่หรือไม่?");
            if (result) {
                stuavatimes.splice(i, 1);
                refreshGridDetailDayList();
            }
        });
    });


    function appendTime(time, i) {
        var dayName = dataDay[time.savDayId - 1].name;
        console.log("time.savStartTime " + time.savStartTime);
        console.log("time.savEndTime " + time.savEndTime);
        var startTimes = dataTime.filter(function (el) {
            return el.val == time.savStartTime;
        });
        var startTime = "";
        if (startTimes[0]) {
            startTime = startTimes[0];
        }
        var endTimes = dataTime.filter(function (el) {
            return el.val == time.savEndTime;
        });
        var endTime = "";
        if (endTimes[0]) {
            endTime = endTimes[0];
        }
        console.log(startTime);
        console.log(endTime);
        var actionTag = "";
        if (time.savNumcls > 0) {
            actionTag = "<button id='btnEditAvaTime' type='button' disabled class='btn btn-xs btn-default command-edit' data-row-id='" + i + "'><div class='fa-pencil'></div></button> "
                    + "<button id='btnDeleteAvaTime' type='button' disabled class='btn btn-xs btn-default command-delete' data-row-id='" + i + "'><div class='fa-trash-o'></div></button>";
        } else {
            actionTag = "<button id='btnEditAvaTime' type='button' class='btn btn-xs btn-default command-edit' data-row-id='" + i + "'><div class='fa-pencil'></div></button> "
                    + "<button id='btnDeleteAvaTime' type='button' class='btn btn-xs btn-default command-delete' data-row-id='" + i + "'><div class='fa-trash-o'></div></button>";
        }
        gridStuTime.bootgrid("append", [
            {
                "id": i + 1,
                "day": dayName,
                "startTime": startTime.name,
                "endTime": endTime.name,
                "location": time.savLocation,
                "action": actionTag
            }
        ]);
    }

    function edittime(i) {
        $('#btnSaveAddTime').val(i);
        console.log(stuavatimes[i]);
        console.log('stuavatimes[i] ' + stuavatimes[i]);
        var location = new google.maps.LatLng(stuavatimes[i].savLat, stuavatimes[i].savLong);
        $('#modalTimeDetailLabel').text('แก้ไขวัน เวลา สถานที่เรียน');
        $('#txtDay').val(dataDay[stuavatimes[i].savDayId - 1].name);
        $('#dropdownStartTime').val(stuavatimes[i].savStartTime);
        $('#dropdownEndTime').val(stuavatimes[i].savEndTime);
        $('#txtPlace').val(stuavatimes[i].savLocation);
        $('#btnStudentGoogleMap').val(location);
        $('#divMultipleDay').hide();
        $('#divTxtDayOfTutor').show();
        $('#modalTimeDetail').modal('show');
    }



    $("#btnAddStuTime").on("click", function (e) {
        console.log("เพิ่ม");
        assignDropDownValueDayAdd();
        $('#btnSaveAddTime').val(-1);
        $('#modalTimeDetailLabel').text('เพิ่มวัน เวลา สถานที่เรียน');
        $('#dropdownStartTime').val($("#dropdownStartTime option:first").val());
        $('#dropdownEndTime').val($("#dropdownEndTime option:first").val());
        $('#txtPlace').val("");

        $('#divMultipleDay').show();
        $('#divTxtDayOfTutor').hide();
    });
    function assignDropDownValueDayAdd() {
        $('#dropdownMultipleDay').empty();
        for (var i = 0; i < dataDay.length; i++) {
            var days = stuavatimes.filter(function (el) {
                return el.savDayId == dataDay[i].val;
            });
            if (days.length == 0) {
                $('#dropdownMultipleDay').append('<option value="' + dataDay[i].val + '">' + dataDay[i].name + '</option>');
            }
        }
    }

    $("#btnStudentGoogleMap").on("click", function (e) {
        var address = $('#txtPlace').val();
        $('#pac-input').val(address);

        if (_isInitGmapStartAndEndPlace == false) {
            _isInitGmapStartAndEndPlace = true;
            initMap();
        }
        var location = $(this).val();
        if (location) {
            location = location.replace('(', '');
            location = location.replace(')', '');
            var loc = location.split(",");
            var lat = parseFloat(loc[0]);
            var lng = parseFloat(loc[1]);
            var latLog = new google.maps.LatLng(lat, lng);
            marker.setPosition(latLog);
            var map = marker.map;
            map.setCenter(latLog);
        }
    });

    function initMap() {
        console.log("INIT MAP");
        var geocoder = new google.maps.Geocoder;
        var latLog = new google.maps.LatLng(13.736334, 100.531102);
        var map = new google.maps.Map(document.getElementById('map'), {
            center: latLog,
            zoom: 15,
            disableDefaultUI: true
        });
        // Set marker
        marker = new google.maps.Marker({
            map: map,
            position: latLog
        });
        google.maps.event.addListener(map, 'click', function (event) {
            setPlaceMarker(event.latLng, geocoder);
        });

        // Search box and auto complete
        var input = document.getElementById('pac-input');
        var options = {
            types: ['establishment']
        };
        var autocomplete = new google.maps.places.Autocomplete(input);
        autocomplete.bindTo('bounds', map);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        autocomplete.addListener('place_changed', function () {
            console.log("Place Changed");
            var place = autocomplete.getPlace();
            placeChangedByAutoComplete(autocomplete.getPlace(), map, geocoder);
        });

    }

    function setPlaceMarker(location, geocoder) {
        marker.setPosition(location);
        console.log(location);
        findAddressFromLocation(location, geocoder);
    }

    function placeChangedByAutoComplete(place, map, geocoder) {
        console.log(place);
        console.log(place.place_id);
        if (!place.place_id) {
            return;
        }
        geocoder.geocode({ 'placeId': place.place_id }, function (results, status) {
            if (status !== 'OK') {
                window.alert('Geocoder failed due to: ' + status);
                return;
            }
            console.log(place.place_id);
            map.setZoom(15);
            map.setCenter(results[0].geometry.location);
            // Set the position of the marker using the place ID and location.
            marker.setPlace({
                placeId: place.place_id,
                location: results[0].geometry.location
            });
            var address = $('#pac-input').val();
            $('#btnStudentGoogleMap').val(results[0].geometry.location);
            $('#txtPlace').val(address);

            $('#modalStudentGoogleMap').modal('hide');

        });
    }

    function findAddressFromLocation(latLng, geocoder) {
        geocoder.geocode({ 'latLng': latLng }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                console.log(results[0]);
                var address = results[0].formatted_address;
                $('#pac-input').val(address);
                $('#btnStudentGoogleMap').val(latLng);
                $('#txtPlace').val(address);
                $('#modalStudentGoogleMap').modal('hide');
            }
            else {
                console.log("Geocoding failed: " + status);
            }
        });
    }


    function geocodeAddress(geocoder, resultsMap) {
        var address = document.getElementById('address').value;
        geocoder.geocode({ 'address': address }, function (results, status) {
            if (status === 'OK') {
                resultsMap.setCenter(results[0].geometry.location);

                var marker = new google.maps.Marker({
                    map: resultsMap,
                    position: results[0].geometry.location
                });
            } else {
                alert('Geocode was not successful for the following reason: ' + status);
            }
        });
    }
    function geocodePlaceId(geocoder, map, placeId) {
        geocoder.geocode({ 'placeId': placeId }, function (results, status) {
            if (status === 'OK') {
                console.log('PLACE');
                if (results[0]) {
                    console.log(results[0]);
                } else {
                    window.alert('No results found');
                }
            } else {
                window.alert('Geocoder failed due to: ' + status);
            }
        });
    }
    $("#btnSaveAddTime").on("click", function (e) {


        var i = $(this).val();
        var selectedStartTime = $("#dropdownStartTime option:selected").val();
        var selectedEndTime = $("#dropdownEndTime option:selected").val();
        console.log(selectedStartTime);
        console.log(selectedEndTime);
        var txtPlace = $("#txtPlace").val();
        console.log(txtPlace);
        var location = $('#btnStudentGoogleMap').val();
        location = location.replace('(', '');
        location = location.replace(')', '');
        var loc = location.split(",");
        console.log(loc);
        var diffTime = Math.abs(parseInt(selectedStartTime) - parseInt(selectedEndTime))
        console.log('time : ', diffTime);
        console.log('start : ', parseInt(selectedStartTime));
        console.log('end : ', parseInt(selectedEndTime));
        if (diffTime < 2 || parseInt(selectedStartTime) > parseInt(selectedEndTime)) {
            console.log('not pass');
            alert('กรุณาตรวจสอบช่วงเวลาเรียนอีกครั้งหนึ่ง ผู้เรียนจะต้องลงเรียนมากกว่า 2 ชั่วโมงต่อวัน');
        } else if (txtPlace == null || txtPlace == "") {
            console.log('not pass');
            alert('กรุณากรอกข้อมูลให้ครบถ้วน');
        } else if (i == -1 && $('#dropdownMultipleDay option:selected').val().length == 0) {
            console.log('not pass ', $('#dropdownMultipleDay option:selected').val().length);
            alert('กรุณากรอกข้อมูลให้ครบถ้วน');
        }
        else {
            var stuId = parseInt($('#dropdownStudentName option:selected').val());
            if (i == -1) {
                $('#dropdownMultipleDay option:selected').each(function () {
                    var timeloc = {
                        "savDayId": parseInt($(this).val()),
                        "savEndTime": selectedEndTime,
                        "savLat": loc[0],
                        "savLocation": txtPlace,
                        "savLong": loc[1],
                        "savStartTime": selectedStartTime,
                        "savStuId": stuId,
                        "savNumcls" : parseInt(0)
                    };
                    console.log(timeloc);
                    stuavatimes.push(timeloc);
                });
            } else {

                var timeloc = stuavatimes[i];
                timeloc.savLocation = txtPlace;
                timeloc.savLat = loc[0];
                timeloc.savLong = loc[1];
                timeloc.savStartTime = selectedStartTime;
                timeloc.savEndTime = selectedEndTime;
                stuavatimes[i] = timeloc;


            }
            refreshGridDetailDayList();
            $('#modalTimeDetail').modal('hide');
        }

/*
        var selectedDay = $("#dropdownDay option:selected").val();
        var selectedStartTime = $("#dropdownStartTime option:selected").val();
        var selectedEndTime = $("#dropdownEndTime option:selected").val();
        var txtPlace = $("#txtPlace").val();
        console.log(txtPlace);
        var location = $('#btnStudentGoogleMap').val();
        location = location.replace('(', '');
        location = location.replace(')', '');
        var loc = location.split(",");
        console.log(loc);
        var i = $(this).val();

        if (i == -1) {
            var timeloc = {
                "savDayId": selectedDay,
                "savEndTime": selectedEndTime,
                "savLat": loc[0],
                "savLocation": txtPlace,
                "savLong": loc[1],
                "savStartTime": selectedStartTime,
                "savStuId": _gUser.stuId
            };
            console.log(timeloc);
            stuavatimes.push(timeloc);
        } else {
            var timeloc = stuavatimes[i];
            timeloc.savLocation = txtPlace;
            timeloc.savLat = loc[0];
            timeloc.savLong = loc[1];
            timeloc.savStartTime = selectedStartTime;
            timeloc.savEndTime = selectedEndTime;
            stuavatimes[i] = timeloc;
        }
        refreshGridDetailDayList();
        $('#modalTimeDetail').modal('hide');*/
    });

    function refreshGridDetailDayList() {
        gridStuTime.bootgrid('clear');
        for (var j = 0; j < stuavatimes.length; j++) {
            console.log("data : " + stuavatimes[j]);
            appendTime(stuavatimes[j], j);
        }
    }

    $("#btnCreateClassNoSpecific").on("click", function (e) {
        // create new class
        if (applySubjects.length > 0 && stuavatimes.length > 0) {
                savenotspecifictutors();

        } else {
            $(".alert-danger").find("strong").text('โปรดระบุข้อมูลให้ครบถ้วน');
            $(".alert-danger").show();
            $('html, body').animate({ scrollTop: $('.breadcrumb').offset().top }, 'fast');
        }
    });

    function savenotspecifictutors() {
        console.log("savenotspecifictutors");
        var programId = $("input[name='gridRadios']:checked").val();;
        var tutorSex = $('#dropdownTutorSex option:selected').val();
        var universityChecked = [];
        $("#chkTutorUni").find("input[type='checkbox']:checked").each(function () {
            console.log("uniid :" + this.name);
            universityChecked.push(parseInt(this.name));
        });
        var facultyChecked = [];
        $("#chkTutorFac").find("input[type='checkbox']:checked").each(function () {
            console.log("facId :" + this.name);
            facultyChecked.push(parseInt(this.name));
        });
        var exp = "N";
        if ($('#chkExp').checked) {
            exp = "Y";
        }
        var stuFirstName = $('#txtStudentFirstName').val();
        var stuLastName = $('#txtStudentLastName').val();
        var stuNickName = $('#txtNickname').val();
        var stuEmail = $('#txtEmail').val();
        var stuTel = $('#txtTel').val();
        var stuSex = $('#dropdownSex option:selected').val();
        var stuLevel = $('#dropdownLevel option:selected').text();
        var stuSchool = $('#txtSchool').val();

        var stuId = parseInt($('#dropdownStudentName option:selected').val());
        var row1 = parseInt($('#sort-table tr:nth-child(1) td:nth-child(1)').text());
        var row2 = parseInt($('#sort-table tr:nth-child(2) td:nth-child(1)').text());
        var row3 = parseInt($('#sort-table tr:nth-child(3) td:nth-child(1)').text());
        var row4 = parseInt($('#sort-table tr:nth-child(4) td:nth-child(1)').text());
        var tutorSpecOrder;
        if (row1 == 2 || row1 == '2') {
            tutorSpecOrder = [row1, 3, row2, row3, row4];
        } else if (row2 == 2  || row2 == '2') {
            tutorSpecOrder = [row1, row2, 3, row3, row4];
        } else if (row3 == 2  || row3 == '2') {
            tutorSpecOrder = [row1, row2, row3, 3, row4];
        } else {
            tutorSpecOrder = [row1, row2, row3, row4, 3];
        }

        if (_gHasClass == 'Y') {
            var bodyRequest = {
                parId: parseInt(_gUser.parId),
                stuId: stuId,
                stuFirstName:stuFirstName,
                stuLastName:stuLastName,
                stuNickName:stuNickName,
                stuEmail:stuEmail,
                stuTel:stuTel,
                stuSex:stuSex,
                stuLevel:stuLevel,
                stuSchool:stuSchool,
                hasClass: 'Y',
                subjectlist: applySubjects,
                programId: parseInt(programId),
                tutorSex: tutorSex,
                universityChecked: universityChecked,
                facultyChecked: facultyChecked,
                tutorExp: exp,
                tutorSpecOrder: tutorSpecOrder,
                studentAvailableTimelocations : stuavatimes
            }
        } else {
            var bodyRequest = {
                parId: parseInt(_gUser.parId),
                stuId: stuId,
                stuFirstName:stuFirstName,
                stuLastName:stuLastName,
                stuNickName:stuNickName,
                stuEmail:stuEmail,
                stuTel:stuTel,
                stuSex:stuSex,
                stuLevel:stuLevel,
                stuSchool:stuSchool,
                hasClass: 'N',
                studentAvailableTimelocations: stuavatimes,
                subjectlist: applySubjects,
                programId: parseInt(programId),
                tutorSex: tutorSex,
                universityChecked: universityChecked,
                facultyChecked: facultyChecked,
                tutorExp: exp,
                tutorSpecOrder: tutorSpecOrder
            }
        }
        console.log(bodyRequest);
        callRequestnewclassNon(bodyRequest);
    }

    function callRequestnewclassNon(bodyRequest) {
        console.log(bodyRequest);
        
        $.ajax({
            type: "POST",
            url: _gServiceURL + "class/requestnewclass/nonspecific",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(bodyRequest),
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                $(".alert-danger").hide();
                $(".alert-success").show();
                $('html, body').animate({ scrollTop: $('.breadcrumb').offset().top }, 'fast');
                _gHasClass = data.data._gHasClass;
                loadMainPage();
            },
            error: function (jqXHR, status) {
                $(".alert-success").hide();
                $(".alert-danger").show();
                $('html, body').animate({ scrollTop: $('.breadcrumb').offset().top }, 'fast');
            }

        });
    }

    /*-- Specific TUtor --*/

    _gSpecificTutor = null;

    var gridSpecTutorAva = $("#gridSpecTutorAva").bootgrid({
        navigation: 0,
        labels: {
            noResults: 'ไม่พบรายการ'
        }
    });
    var gridStudentAva = $("#gridStudentAva").bootgrid({
        navigation: 0,
        labels: {
            noResults: 'ไม่พบรายการ'
        }
    }).on("loaded.rs.jquery.bootgrid", function () {
        gridStudentAva.find(".command-edit").on("click", function (e) {
            var i = parseInt($(this).data("row-id"));
            editStudentSpecTime(i);
        }).end().find(".command-delete").on("click", function (e) {
            var i = parseInt($(this).data("row-id"));
            var dayName = dataDay[stuSpecAvatimes[i].carDayId - 1].name;
            var result = confirm("ต้องการลบรายการ " + dayName + " ใช่หรือไม่?");
            if (result) {
                stuSpecAvatimes.splice(i, 1);
                refreshGridDetailDaySpecList();
            }
        });
    });

    $("#dropdownSpecSubject").change(function () {
        $('#dropdownSpecLevel').empty();
        var subjId = this.value;
        var subjectBySubjid = subjects.filter(function (el) {
            return el.subjId == subjId;
        });
        console.log(subjectBySubjid);

        if (subjectBySubjid[0]) {
            var subjectCatagories = subjectBySubjid[0].subjectCatagories;
            console.log(subjectCatagories);
            for (var i = 0; i < subjectCatagories.length; i++) {
                $('#dropdownSpecLevel').append('<option value="' + subjectCatagories[i].subcId + '">' + subjectCatagories[i].subcName + '</option>');
            }
        }
        getTutorList();
        stuSpecAvatimes = [];
        refreshGridDetailDaySpecList();
    });

    $("#dropdownSpecLevel").change(function () {
        getSpecPrice();
        getTutorList();
        stuSpecAvatimes = [];
        refreshGridDetailDaySpecList();

    });
    $("#dropdownSpecNumStu").change(function () {
        getSpecPrice();
    });

    $("input[name='radioProgs']:checked").change(function () {
        getTutorList();
        stuSpecAvatimes = [];
        refreshGridDetailDaySpecList();
    });
    function getSpecPrice() {
        var subjId = parseInt($('#dropdownSpecSubject option:selected').val());
        var subcId = parseInt($('#dropdownSpecLevel option:selected').val());
        var numStu = parseInt($('#dropdownSpecNumStu option:selected').val());
        console.log(_gServiceURL + "subjectprice/getprice/" + subjId + "/" + subcId + "/" + numStu);
        $.ajax({
            type: "GET",
            url: _gServiceURL + "subjectprice/getprice/" + subjId + "/" + subcId + "/" + numStu,
            contentType: "application/json; charset=utf-8",
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                console.log(data.data);
                var subjectPrice = data.data.subjectPrice;
                $('#txtSpecPrice').val(subjectPrice.sprPrice);
            },
            error: function (jqXHR, status) {
                console.log(jqXHR);
                alert('fail' + status.code);
            }
        });
    }

    function getTutorList() {
        $('#dropdownSpecTutor').empty();
        _gSpecificTutor = null;
        var subjId = parseInt($('#dropdownSpecSubject option:selected').val());
        var subcId = parseInt($('#dropdownSpecLevel option:selected').val());
        var programId = parseInt($("input[name='radioProgs']:checked").val());
        var bodyRequest = {
            subcId: subcId,
            subjId: subjId,
            programId: programId
        };
        console.log(bodyRequest);
        $.ajax({
            type: "POST",
            url: _gServiceURL + "tutor/findBySubjCatAndProg",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(bodyRequest),
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                console.log(data.data.tutorViews);
                _gSpecificTutor = data.data.tutorViews;
                for (var i = 0; i < _gSpecificTutor.length; i++) {
                    $('#dropdownSpecTutor').append('<option value="' + _gSpecificTutor[i].turId + '">' + _gSpecificTutor[i].turName + '</option>');
                }
            },
            error: function (jqXHR, status) {
            }

        });
    }

    $("#dropdownSpecTutor").change(function () {
        var turId = this.value;
        var specificTutorByTurId = _gSpecificTutor.filter(function (el) {
            return el.turId == turId;
        });
        console.log(specificTutorByTurId);
        $('#txtSpecTurSex').val(specificTutorByTurId[0].turSex);
        $('#txtSpecTurFac').val(specificTutorByTurId[0].turFacName);
        $('#txtSpecTurUni').val(specificTutorByTurId[0].turUniName);
        $('#txtSpecTurExp').val(specificTutorByTurId[0].turExp);
        $('#txtSpecTurClip').val(specificTutorByTurId[0].turClip);
        var times = specificTutorByTurId[0].tutorAvailableTimeloacationViews;
        console.log(times);
        gridSpecTutorAva.bootgrid('clear');
        for (var i = 0; i < times.length; i++) {
            console.log(times[i].tavDayId);
            appendTutorTime(times[i], i);
        }

    });

    function appendTutorTime(time, i) {
        console.log("TIME : ", time);
        gridSpecTutorAva.bootgrid("append", [
            {
                "id": i + 1,
                "day": time.tavDay,
                "time": time.tavStartTime + " - " + time.tavEndTime,
                "startPlace": time.tavStartLocation,
                "endPlace": time.tavEndLocation
            }
        ]);


    }
    function addStudentSpecTime() {
        $('#dropdownDayOfTutorSpec').empty();
        var turId = $('#dropdownSpecTutor option:selected').val();
        var specificTutorByTurId = _gSpecificTutor.filter(function (el) {
            return el.turId == turId;
        });

        var times = specificTutorByTurId[0].tutorAvailableTimeloacationViews;
        var newTimes;
        for (var i = 0; i < times.length; i++) {
            var days = stuSpecAvatimes.filter(function (el) {
                return el.carDayId == times[i].tavDayId;
            });
            if (days.length == 0) {
                $('#dropdownDayOfTutorSpec').append('<option value="' + times[i].tavDayId + '">' + times[i].tavDay + '</option>');
            }
        }
        console.log(times);
        $('#btnSpecSaveAddTime').val(-1);
        $('#modalStuAvaLabel').text('เพิ่มวัน เวลา สถานที่เรียน');
        $('#divTxtDayOfTutorSpec').hide();
        $('#divDropdownDayOfTutorSpec').show();
        $('#dropdownSpecStartTime').val($("#dropdownSpecStartTime option:first").val());
        $('#dropdownSpecEndTime').val($("#dropdownSpecEndTime option:first").val());
        $('#txtStudyPlace').val('');
        //$('#modalStuAva').modal('show');

    }

    for (var i = 0; i < dataTime.length; i++) {
        $('#dropdownSpecStartTime').append('<option value="' + dataTime[i].val + '">' + dataTime[i].name + '</option>');
        $('#dropdownSpecEndTime').append('<option value="' + dataTime[i].val + '">' + dataTime[i].name + '</option>');
    }

    // Google map for spec tutor
    $("#btnSpecStudentGoogleMap").on("click", function (e) {
        var address = $('#txtStudyPlace').val();
        $('#spec-pac-input').val(address);

        if (_isInitGmapStartAndEndPlaceSpec == false) {
            _isInitGmapStartAndEndPlaceSpec = true;
            initMapSpec();
        }
        var location = $(this).val();
        if (location) {
            location = location.replace('(', '');
            location = location.replace(')', '');
            var loc = location.split(",");
            var lat = parseFloat(loc[0]);
            var lng = parseFloat(loc[1]);
            var latLog = new google.maps.LatLng(lat, lng);
            specmarker.setPosition(latLog);
            var map = marker.map;
            map.setCenter(latLog);
        }
    });

    function initMapSpec() {
        console.log("INIT MAP SPEC");
        var geocoder = new google.maps.Geocoder;
        var latLog = new google.maps.LatLng(13.736334, 100.531102);
        var map = new google.maps.Map(document.getElementById('spec-map'), {
            center: latLog,
            zoom: 15,
            disableDefaultUI: true
        });
        // Set marker
        specmarker = new google.maps.Marker({
            map: map,
            position: latLog
        });
        google.maps.event.addListener(map, 'click', function (event) {
            setPlaceMarkerSpec(event.latLng, geocoder);
        });

        // Search box and auto complete
        var input = document.getElementById('spec-pac-input');
        var options = {
            types: ['establishment']
        };
        var autocomplete = new google.maps.places.Autocomplete(input);
        autocomplete.bindTo('bounds', map);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        autocomplete.addListener('place_changed', function () {
            console.log("Place Changed");
            var place = autocomplete.getPlace();
            placeChangedByAutoCompleteSpec(autocomplete.getPlace(), map, geocoder);
        });

    }

    function setPlaceMarkerSpec(location, geocoder) {
        specmarker.setPosition(location);
        console.log(location);
        findAddressFromLocationSpec(location, geocoder);
    }

    function placeChangedByAutoCompleteSpec(place, map, geocoder) {
        console.log(place);
        console.log(place.place_id);
        if (!place.place_id) {
            return;
        }
        geocoder.geocode({ 'placeId': place.place_id }, function (results, status) {
            if (status !== 'OK') {
                window.alert('Geocoder failed due to: ' + status);
                return;
            }
            console.log(place.place_id);
            map.setZoom(15);
            map.setCenter(results[0].geometry.location);
            // Set the position of the marker using the place ID and location.
            specmarker.setPlace({
                placeId: place.place_id,
                location: results[0].geometry.location
            });
            var address = $('#spec-pac-input').val();
            $('#btnSpecStudentGoogleMap').val(results[0].geometry.location);
            $('#txtStudyPlace').val(address);

            $('#modalSpecStudentGoogleMap').modal('hide');

        });
    }

    function findAddressFromLocationSpec(latLng, geocoder) {
        geocoder.geocode({ 'latLng': latLng }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                console.log(results[0]);
                var address = results[0].formatted_address;
                $('#spec-pac-input').val(address);
                $('#btnSpecStudentGoogleMap').val(latLng);
                $('#txtStudyPlace').val(address);
                $('#modalSpecStudentGoogleMap').modal('hide');
            }
            else {
                console.log("Geocoding failed: " + status);
            }
        });
    }

    function addStudentTimeSpec() {

        var i = parseInt($('#btnSpecSaveAddTime').val());
        var selectedStartTime = $("#dropdownSpecStartTime option:selected").val();
        var selectedEndTime = $("#dropdownSpecEndTime option:selected").val();
        console.log(selectedStartTime);
        console.log(selectedEndTime);
        var txtPlace = $("#txtStudyPlace").val();
        console.log(txtPlace);
        var location = $('#btnSpecStudentGoogleMap').val();
        location = location.replace('(', '');
        location = location.replace(')', '');
        var loc = location.split(",");
        console.log(loc);
        var diffTime = Math.abs(parseInt(selectedStartTime) - parseInt(selectedEndTime))
        console.log('time : ', diffTime);
        console.log('start : ', parseInt(selectedStartTime));
        console.log('end : ', parseInt(selectedEndTime));
        if (diffTime < 2 || parseInt(selectedStartTime) > parseInt(selectedEndTime)) {
            console.log('not pass');
            alert('กรุณาตรวจสอบช่วงเวลาเรียนอีกครั้งหนึ่ง ผู้เรียนจะต้องลงเรียนมากกว่า 2 ชั่วโมงต่อวัน');
        } else if (txtPlace == null || txtPlace == "") {
            console.log('not pass');
            alert('กรุณากรอกข้อมูลให้ครบถ้วน');
        } else if (i == -1 && $('#dropdownDayOfTutorSpec option:selected').val().length == 0) {
            console.log('not pass ', $('#dropdownDayOfTutorSpec option:selected').val().length);
            alert('กรุณากรอกข้อมูลให้ครบถ้วน');
        }
        else {

            if (i == -1) {
                $('#dropdownDayOfTutorSpec option:selected').each(function () {
                    var timeloc = {
                        "carDayId": parseInt($(this).val()),
                        "carEndtime": selectedEndTime,
                        "carLocLat": loc[0],
                        "carLocName": txtPlace,
                        "carLocLong": loc[1],
                        "carStarttime": selectedStartTime
                    };
                    console.log(timeloc);
                    stuSpecAvatimes.push(timeloc);
                });
            } else {

                var timeloc = stuSpecAvatimes[i];
                timeloc.carLocName = txtPlace;
                timeloc.carLocLat = loc[0];
                timeloc.carLocLong = loc[1];
                timeloc.carStarttime = selectedStartTime;
                timeloc.carEndtime = selectedEndTime;
                stuSpecAvatimes[i] = timeloc;


            }
            refreshGridDetailDaySpecList();
            $('#modalStuAva').modal('hide');
        }
    }

    function refreshGridDetailDaySpecList() {
        gridStudentAva.bootgrid('clear');
        for (var j = 0; j < stuSpecAvatimes.length; j++) {
            console.log("data : " + stuSpecAvatimes[j]);
            appendTimeStudentSpec(stuSpecAvatimes[j], j);
        }
    }

    function appendTimeStudentSpec(time, i) {
        var dayName = dataDay[time.carDayId - 1].name;
        console.log("time.carStarttime " + time.carStarttime);
        console.log("time.carEndtime " + time.carEndtime);
        var startTimes = dataTime.filter(function (el) {
            return el.val == time.carStarttime;
        });
        var startTime = "";
        if (startTimes[0]) {
            startTime = startTimes[0];
        }
        var endTimes = dataTime.filter(function (el) {
            return el.val == time.carEndtime;
        });
        var endTime = "";
        if (endTimes[0]) {
            endTime = endTimes[0];
        }
        console.log(startTime);
        console.log(endTime);
        gridStudentAva.bootgrid("append", [
            {
                "id": i + 1,
                "day": dayName,
                "startTime": startTime.name,
                "endTime": endTime.name,
                "location": time.carLocName,
                "action": "<button id='btnEditSpecAvaTime' type='button' class='btn btn-xs btn-default command-edit' data-row-id='" + i + "'><div class='fa-pencil'></div></button> "
                    + "<button id='btnDeleteSpecAvaTime' type='button' class='btn btn-xs btn-default command-delete' data-row-id='" + i + "'><div class='fa-trash-o'></div></button>"
            }
        ]);
    }
    function editStudentSpecTime(i) {
        $('#btnSpecSaveAddTime').val(i);
        var location = new google.maps.LatLng(stuSpecAvatimes[i].carLat, stuSpecAvatimes[i].carLong);
        $('#modalStuAvaLabel').text('แก้ไขวัน เวลา สถานที่เรียน');
        $('#divTxtDayOfTutorSpec').show();
        $('#divDropdownDayOfTutorSpec').hide();
        $('#txtSpecDay').val(dataDay[stuSpecAvatimes[i].carDayId - 1].name);
        $('#divTxtDayOfTutorSpec').prop('disabled', true);
        $('#dropdownSpecStartTime').val(stuSpecAvatimes[i].carStarttime);
        $('#dropdownSpecEndTime').val(stuSpecAvatimes[i].carEndtime);
        $('#txtStudyPlace').val(stuSpecAvatimes[i].carLocName);
        $('#btnSpecStudentGoogleMap').val(location);
        $('#modalStuAva').modal('show');
    }



    $("#btnCreateClassSpecific").on("click", function (e) {
        // create new class
        var programId = parseInt($("input[name='radioProgs']:checked").val());
        var subjId = parseInt($('#dropdownSpecSubject option:selected').val());
        var subcId = parseInt($('#dropdownSpecLevel option:selected').val());
        var turId = parseInt($('#dropdownSpecTutor option:selected').val());
        var numStu = parseInt($('#dropdownSpecNumStu option:selected').val());
        var totalHours = parseInt($('#dropdownSpecTotalHours option:selected').val());

        if (programId != null && subjId != null && subcId != null && turId != null && numStu != null && totalHours != null
            && stuSpecAvatimes.length > 0) {
            savespecifictutors(programId, subjId, subcId, turId, numStu, totalHours, stuSpecAvatimes);
        } else {
            $(".alert-danger").find("strong").text('โปรดระบุข้อมูลให้ครบถ้วน');
            $(".alert-danger").show();
            $('html, body').animate({ scrollTop: $('.breadcrumb').offset().top }, 'fast');
        }
    });

    function savespecifictutors(programId, subjId, subcId, turId, numStu, totalHours, stuSpecAvatimes) {

        console.log("savespecifictutors");
        var stuId = parseInt($('#dropdownStudentName option:selected').val());
        var bodyRequest = {
            stuId: parseInt(stuId),
            subcId: subcId,
            subjId: subjId,
            turId: turId,
            programId: programId,
            numStu: numStu,
            totalHours: totalHours,
            stuSpecAvatimes: stuSpecAvatimes
        }
        console.log(bodyRequest);
        callRequestnewclassSpec(bodyRequest);
    }

    function callRequestnewclassSpec(bodyRequest) {
        console.log(bodyRequest);
        $.ajax({
            type: "POST",
            url: _gServiceURL + "class/requestnewclass/specific",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(bodyRequest),
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                $(".alert-danger").hide();
                $(".alert-success").show();
                $('html, body').animate({ scrollTop: $('.breadcrumb').offset().top }, 'fast');
                _gHasClass = data.data._gHasClass;
                loadMainPage();
            },
            error: function (jqXHR, status) {
                $(".alert-success").hide();
                $(".alert-danger").show();
                $('html, body').animate({ scrollTop: $('.breadcrumb').offset().top }, 'fast');
            }

        });
    }

    // Student Name Spec

    $("#dropdownStudentNameSpec").change(function () {
        if ($(this).val() != 0) {
            var stuId = $(this).val();
            console.log(stuId);
            var studentsByStuId = _gStudents.filter(function (el) {
                return el.stuId == stuId;
            });
            console.log(studentsByStuId[0]);
            $('#divStudentFirstNameSpec').hide();
            $('#divStudentLastNameSpec').hide();
            $('#txtNicknameSpec').val(studentsByStuId[0].stuNickname);
            $('#txtEmailSpec').val(studentsByStuId[0].stuEmail);
            $('#txtTelSpec').val(studentsByStuId[0].stuPhonenum);
            $('#dropdownSexSpec').val(studentsByStuId[0].stuSex);
            $('#dropdownLevelSpec').val(studentsByStuId[0].stuLevel);
            $('#txtSchoolSpec').val(studentsByStuId[0].stuSchool);

        } else {
            $('#divStudentFirstNameSpec').show();
            $('#divStudentLastNameSpec').show();
            $('#txtNicknameSpec').val("");
            $('#txtEmailSpec').val("");
            $('#txtTelSpec').val("");
            $('#dropdownSexSpec').val("");
            $('#dropdownLevelSpec').val("");
            $('#txtSchoolSpec').val("");

        }
    });
    for (var i = 0; i < dataLevel.length; i++) {
        $('#dropdownLevelSpec').append('<option value="' + dataLevel[i].val + '">' + dataLevel[i].name + '</option>');
    }

    $("#dropdownStudentName").change(function () {
        if ($(this).val() != 0) {
            var stuId = $(this).val();
            console.log(stuId);
            var studentsByStuId = _gStudents.filter(function (el) {
                return el.stuId == stuId;
            });
            console.log(studentsByStuId[0]);
            $('#divStudentFirstName').hide();
            $('#divStudentLastName').hide();
            $('#txtNickname').val(studentsByStuId[0].stuNickname);
            $('#txtEmail').val(studentsByStuId[0].stuEmail);
            $('#txtTel').val(studentsByStuId[0].stuPhonenum);
            $('#dropdownSex').val(studentsByStuId[0].stuSex);
            $('#dropdownLevel').val(studentsByStuId[0].stuLevel);
            $('#txtSchool').val(studentsByStuId[0].stuSchool);
            stuavatimes = studentsByStuId[0].studentAvailableTimelocations;
            console.log(stuavatimes);
            for (var i = 0; i < stuavatimes.length; i++) {
                appendTime(stuavatimes[i], i);
            }
        } else {
            $('#divStudentFirstName').show();
            $('#divStudentLastName').show();
            $('#txtNickname').val("");
            $('#txtEmail').val("");
            $('#txtTel').val("");
            $('#dropdownSex').val("");
            $('#dropdownLevel').val("");
            $('#txtSchool').val("");

        }
    });
    for (var i = 0; i < dataLevel.length; i++) {
        $('#dropdownLevel').append('<option value="' + dataLevel[i].val + '">' + dataLevel[i].name + '</option>');
    }


</script>

</html>