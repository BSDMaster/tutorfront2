<!DOCTYPE html>
<!-- saved from url=(0048)http://getbootstrap.com/2.3.2/examples/hero.html -->
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <title>TUTOR MATCHING</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Le styles -->
  <!--<link href="./library/bootstrap.css" rel="stylesheet">-->

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <!--Library Table-->
  <script src="./library/bootgrid/jquery.bootgrid.js"></script>
  <script src="./library/bootgrid/jquery.bootgrid.fa.js"></script>
  <link href="./library/bootgrid/jquery.bootgrid.css" rel="stylesheet">

  <!--Library FullCalendar-->
  <!--<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.js"></script>
  <link href="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.print.css" rel="stylesheet">-->

  <!--<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.2/moment.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.1.1/fullcalendar.min.js"></script>-->
  <!--
  <script src="./library/fullCalendar/fullcalendar.js"></script>
  <link href="./library/fullCalendar/fullcalendar.css" rel="stylesheet">
  <link href="./library/fullCalendar/fullcalendar.print.css" rel="stylesheet">

-->
  <link href="./library/bootstrap-responsive.css" rel="stylesheet">
  <!--Override CSS-->
  <!--    <link href="./css/bootstrap.css" rel="stylesheet">-->
  <link href="./css/bootstrap.min.css" rel="stylesheet">
  <link href="./css/style.css" rel="stylesheet">
  <link href="./css/override.css" rel="stylesheet">
  <!--Google Map-->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC3CqYZxIposJwTiB-GAGSYBRRHIi0x6_Y&libraries=places&language=th-TH"></script>
  <!-- Bootstrap Date-Picker Plugin -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css"
  />

  <!--Facebook-->
  <script src="//connect.facebook.net/en_US/all.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.css" rel="stylesheet">

  <!--Eva Tutor-->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg"
    crossorigin="anonymous">

  <script>
    _gUserEmail = 'student1@gmail.com';  //bypass login
    _gUserType = 'student';
    _gSelectedClsId = 0;
    _gSelectedMerId = 0;
    _gRec = {
      recId: null,
      recType: null
    };
    _gUser = {
      turId: null,
      turName: null,
      stuId: null,
      stuName: null
    };
    _gFBUser = {
      email : null,
      firstName : null,
      lastName : null
    }
    _gUser.turId = null;
    _gUser.turName = null;
    _gUser.stuId = null;
    _gUser.stuName = null;
    _gUser.parId = null;
    _gUser.parName = null;
    _gNoResultFound = 'ไม่พบรายการ';
   // _gServiceURL = 'https://d1a75d86.ngrok.io/tutormatchingservices-0.0.1-SNAPSHOT/';
    _gServiceURL = 'http://localhost:8080/tutormatchingservices-0.0.1-SNAPSHOT/';
    _gHasClass = 'Y';
    _gHasTutorTime = 'Y';
    //day
    dataDay = [{
      name: "จันทร์", val: "1"
    }, {
      name: "อังคาร", val: "2"
    }, {
      name: "พุธ", val: "3"
    }, {
      name: "พฤหัสบดี", val: "4"
    }, {
      name: "ศุกร์", val: "5"
    }, {
      name: "เสาร์", val: "6"
    }, {
      name: "อาทิตย์", val: "7"
    }];
    //time
    dataTime = [{
      name: "8.00 น.", val: "8"
    }, {
      name: "8.30 น.", val: "8.3"
    }, {
      name: "9.00 น.", val: "9"
    }, {
      name: "9.30 น.", val: "9.3"
    }, {
      name: "10.00 น.", val: "10"
    }, {
      name: "10.30 น.", val: "10.3"
    }, {
      name: "11.00 น.", val: "11"
    }, {
      name: "11.30 น.", val: "11.3"
    }, {
      name: "12.00 น.", val: "12"
    }, {
      name: "12.30 น.", val: "12.3"
    }, {
      name: "13.00 น.", val: "13"
    }, {
      name: "13.30 น.", val: "13.3"
    }, {
      name: "14.00 น.", val: "14"
    }, {
      name: "14.30 น.", val: "14.3"
    }, {
      name: "15.00 น.", val: "15"
    }, {
      name: "15.30 น.", val: "15.3"
    }, {
      name: "16.00 น.", val: "16"
    }, {
      name: "16.30 น.", val: "16.3"
    }, {
      name: "17.00 น.", val: "17"
    }, {
      name: "17.30 น.", val: "17.3"
    }, {
      name: "18.00 น.", val: "18"
    }, {
      name: "18.30 น.", val: "18.3"
    }, {
      name: "19.00 น.", val: "19"
    }, {
      name: "19.30 น.", val: "19.3"
    }, {
      name: "20.00 น.", val: "20"
    }];
    dataLevel = [{
      name: "อนุบาลศึกษาปีที่ 1", val: "อนุบาลศึกษาปีที่ 1"
    }, {
      name: "อนุบาลศึกษาปีที่ 2", val: "อนุบาลศึกษาปีที่ 2"
    }, {
      name: "อนุบาลศึกษาปีที่ 3", val: "อนุบาลศึกษาปีที่ 3"
    }, {
      name: "ประถมศึกษาปีที่ 1", val: "ประถมศึกษาปีที่ 1"
    }, {
      name: "ประถมศึกษาปีที่ 2", val: "ประถมศึกษาปีที่ 2"
    }, {
      name: "ประถมศึกษาปีที่ 3", val: "ประถมศึกษาปีที่ 3"
    }, {
      name: "ประถมศึกษาปีที่ 4", val: "ประถมศึกษาปีที่ 4"
    }, {
      name: "ประถมศึกษาปีที่ 5", val: "ประถมศึกษาปีที่ 5"
    }, {
      name: "ประถมศึกษาปีที่ 6", val: "ประถมศึกษาปีที่ 6"
    }, {
      name: "มัธยมศึกษาปีที่ 1", val: "มัธยมศึกษาปีที่ 1"
    }, {
      name: "มัธยมศึกษาปีที่ 2", val: "มัธยมศึกษาปีที่ 2"
    }, {
      name: "มัธยมศึกษาปีที่ 3", val: "มัธยมศึกษาปีที่ 3"
    }, {
      name: "มัธยมศึกษาปีที่ 4", val: "มัธยมศึกษาปีที่ 4"
    }, {
      name: "มัธยมศึกษาปีที่ 5", val: "มัธยมศึกษาปีที่ 5"
    }, {
      name: "มัธยมศึกษาปีที่ 6", val: "มัธยมศึกษาปีที่ 6"
    }, {
      name: "ระดับปริญญาตรี", val: "ระดับปริญญาตรี"
    }, {
      name: "อื่นๆ", val: "อื่นๆ"
    }];
  </script>
</head>

<body data-gr-c-s-loaded="true" style="padding-top: 0px;">
  <nav id="divFirstNavBar" class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand mb-0 h1"></a>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="nav navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="javascript:changePage('./html/rate.html');">อัตราค่าเรียน</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="javascript:changePage('./html/registerstudent.html');">สมัครเรียน</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="javascript:changePage('./html/tutorSubscription.html');">สมัครสมาชิกติวเตอร์</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="javascript:changePage('./html/login.html');">เข้าสู่ระบบ</a>
          </li>
        </ul>
      </div>
    </div>

  </nav>
  <nav id="divMainNavBar" class="navbar navbar-expand-lg navbar-dark bg-primary" style="display:none;">

    <div class="container-fluid">

      <!--<div class="navbar-header">-->

      <a class="navbar-brand mb-0 h1" href="javascript:loadMainPage();" id="divUserType">Tutor</a>
      <!--  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
    </div>-->
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="nav navbar-nav ml-auto">
          <li class="nav-item" id="nav-itm-student-schedule">
            <a class="nav-link" href="javascript:changePage('./html/schedule.html');">ตารางสอน</a>
          </li>
          <li class="nav-item" id="nav-itm-tutor-schedule">
            <a class="nav-link" href="javascript:changePage('./html/schedule.html');">ตารางสอน</a>
          </li>
          <li class="nav-item" id="nav-itm-rate">
            <a class="nav-link" href="javascript:changePage('./html/rate.html');">อัตราค่าเรียน</a>
          </li>
          <li class="nav-item" id="nav-itm-publishJob">
            <a class="nav-link" href="javascript:changePage('./html/publishJob.html');">แก้ไขข้อมูลการรับงานสอน</a>
          </li>
          <li class="nav-item" id="nav-itm-stu-avatime">
            <a class="nav-link" href="javascript:changePage('./html/studentavatime.html');">แก้ไขวันและเวลาว่างของนักเรียน</a>
          </li>
          <li class="nav-item" id="nav-itm-registerClass">
            <a class="nav-link" href="javascript:changePage('./html/studenteditclass.html');">สมัครเรียนเพิ่มเติม</a>
          </li>
          <li class="nav-item" id="nav-itm-registerClass-forparent">
            <a class="nav-link" href="javascript:changePage('./html/parenteditclass.html');">สมัครเรียนเพิ่มเติม</a>
          </li>
          <li class="nav-item dropdown">

            <a id="divShowUser" class="nav-link dropdown-toggle" data-toggle="dropdown">User</a>
            <div class="dropdown-menu">
              <a class="dropdown-item" id="nav-itm-student-profile" href="javascript:changePage('./html/studentprofile.html');">ข้อมูลส่วนตัว</a>
              <a class="dropdown-item" id="nav-itm-tutor-profile" href="javascript:changePage('./html/tutorprofile.html');">ข้อมูลส่วนตัว</a>
              <a class="dropdown-item" href="javascript:changePage('./html/changepassword.html');">เปลี่ยนรหัสผ่าน</a>
              <a class="dropdown-item" href="javascript:logout();">ออกจากระบบ</a>
            </div>
          </li>
        </ul>
      </div>
    </div>

  </nav>
  <div id="divMainContainer" class="container">

  </div>
  <!-- /container -->


  <script>

    jQuery(document).ready(function () {
      console.log("ready!");
      if (_gUser.turId == null) {
        jQuery("#divMainContainer").load('./html/promote.html');
      }
      else {
        loadMainPage();
      }
    });

    function changePage(page) {
      jQuery("#divMainContainer").load(page);
    }

    function login(email, password, userType) {
      _gUserEmail = email;
      var data = {
        email: email,
        password: password
      }

      //testOnly
      if (userType == "tutor") {
        tutorLogin(data);
      }
      else {
        studentLogin(data);
      }
    }

    function fblogin(email, firstName, lastName, userType) {
      _gUserEmail = email;
      _gFBUser.email = email;
      _gFBUser.firstName = firstName;
      _gFBUser.lastName = lastName;
      var data = {
        email: email
      }

      //testOnly
      if (userType == "tutor") {
        tutorFBLogin(data);
      }
      else {
        studentFBLogin(data);
      }
    }

    function tutorLogin(data) {
      console.log("tutor login");
      $.ajax({
        type: "POST",
        url: _gServiceURL + "tutor/login",
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        crossDomain: true,
        dataType: "json",
        success: function (data, status, jqXHR) {
          _gHasTutorTime = data.data.hasTutorTime;
          _gUserType = "tutor";
          _gUser.turId = data.data.id;
          _gUser.turName = data.data.name;
          if (data.data.id != null) {
            jQuery("#divShowUser").html(_gUser.turName);
            console.log(_gUser.turId);
            loadMainPage();
          } else {
            alert("กรุณาตรวจสอบอีเมล์และรหัสผ่าน");
          }
        },

        error: function (jqXHR, status) {
          // error handler
          console.log(jqXHR);
          //alert('fail' + status.code);
        }
      });
    }

    function studentLogin(data) {
      $.ajax({
        type: "POST",
        url: _gServiceURL + "student/login",
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        crossDomain: true,
        dataType: "json",
        success: function (data, status, jqXHR) {
          console.log(data);
          var regisType = data.data.type;
          _gHasClass = data.data.hasClass;
          if (regisType == "P") {
            _gUserType = "parent";
            _gUser.parId = data.data.id;
            _gUser.parName = data.data.name;
            jQuery("#divShowUser").html(_gUser.parName);
            console.log(_gUser.parId);
            console.log(_gUser.parName);
            loadMainPage();
          } else if (regisType == "S") {
            _gUserType = "student";
            _gUser.stuId = data.data.id;
            _gUser.stuName = data.data.name;
            jQuery("#divShowUser").html(_gUser.stuName);
            console.log(_gUser.stuId);
            console.log(_gUser.stuName);
            loadMainPage();
          } else {
            alert("กรุณาตรวจสอบอีเมล์และรหัสผ่าน");
          }

        },

        error: function (jqXHR, status) {
          // error handler
          console.log(jqXHR);
        }
      });
    }

    function tutorFBLogin(data) {
      console.log("tutor fb login");
      $.ajax({
        type: "POST",
        url: _gServiceURL + "tutor/fblogin",
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        crossDomain: true,
        dataType: "json",
        success: function (data, status, jqXHR) {
          if (data.data.id) {
            _gHasTutorTime = data.data.hasTutorTime;
            _gUserType = "tutor";
            _gUser.turId = data.data.id;
            _gUser.turName = data.data.name;
            jQuery("#divShowUser").html(_gUser.turName);
            console.log(_gUser.turId);
            loadMainPage();
          } else {
            changePage('./html/tutorSubscription.html');
          }
        },

        error: function (jqXHR, status) {
          // error handler
          console.log(jqXHR);
          //alert('fail' + status.code);
        }
      });
    }

    function studentFBLogin(data) {
      $.ajax({
        type: "POST",
        url: _gServiceURL + "student/fblogin",
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        crossDomain: true,
        dataType: "json",
        success: function (data, status, jqXHR) {
          console.log(data);
          if (data.data.type) {
            var regisType = data.data.type;
            _gHasClass = data.data.hasClass;
            if (regisType == "P") {
              _gUserType = "parent";
              _gUser.parId = data.data.id;
              _gUser.parName = data.data.name;
              jQuery("#divShowUser").html(_gUser.parName);
              console.log(_gUser.parId);
              console.log(_gUser.parName);
              loadMainPage();
            } else if (regisType == "S") {
              _gUserType = "student";
              _gUser.stuId = data.data.id;
              _gUser.stuName = data.data.name;
              jQuery("#divShowUser").html(_gUser.stuName);
              console.log(_gUser.stuId);
              console.log(_gUser.stuName);
              loadMainPage();
            }
          } else {
            changePage('./html/registerstudent.html');
          }

        },

        error: function (jqXHR, status) {
          // error handler
          console.log(jqXHR);
        }
      });
    }

    function loadMainPage() {
      //   if (_gUser.turId != null) {
      jQuery("#divFirstNavBar").css('display', 'none');
      jQuery("#divMainNavBar").css('display', '');
      //        jQuery("#divShowUser").html(_gUser.turName);

      //_gUserType
      console.log("_gUserType=", _gUserType);
      
      if (_gUserType == "tutor") {
        $('#divUserType').text("ติวเตอร์");
        if (_gHasTutorTime == 'N') {
          jQuery("#divMainContainer").load('./html/publishJob.html');
        } else {
          jQuery("#divMainContainer").load('./html/main.html');
        }
        jQuery("#nav-itm-student-schedule").hide();
        jQuery("#nav-itm-tutor-schedule").hide();
        jQuery("#nav-itm-rate").hide();
        jQuery("#nav-itm-publishJob").show();
        jQuery("#nav-itm-registerClass").hide();
        jQuery("#nav-itm-registerClass-forparent").hide();
        jQuery("#nav-itm-student-profile").hide();
        jQuery("#nav-itm-tutor-profile").show();
        jQuery("#nav-itm-stu-avatime").hide();

      }
      else if (_gUserType == "student") {

        $('#divUserType').text("นักเรียน");
        if (_gHasClass == 'N') {
          jQuery("#divMainContainer").load('./html/studenteditclass.html');
        } else {
          jQuery("#divMainContainer").load('./html/mainStudent.html');
        }
        jQuery("#nav-itm-student-schedule").hide();
        jQuery("#nav-itm-tutor-schedule").hide();
        jQuery("#nav-itm-rate").show();
        jQuery("#nav-itm-publishJob").hide();
        jQuery("#nav-itm-registerClass").show();
        jQuery("#nav-itm-registerClass-forparent").hide();
        jQuery("#nav-itm-student-profile").show();
        jQuery("#nav-itm-tutor-profile").hide();
        jQuery("#nav-itm-stu-avatime").show();
      } else if (_gUserType == "parent") {

        $('#divUserType').text("ผู้ปกครอง");
        if (_gHasClass == 'N') {
          jQuery("#divMainContainer").load('./html/parenteditclass.html');
        } else {
          jQuery("#divMainContainer").load('./html/mainParent.html');
        }
        jQuery("#nav-itm-student-schedule").hide();
        jQuery("#nav-itm-tutor-schedule").hide();
        jQuery("#nav-itm-rate").show();
        jQuery("#nav-itm-publishJob").hide();
        jQuery("#nav-itm-registerClass").hide();
        jQuery("#nav-itm-registerClass-forparent").show();
        jQuery("#nav-itm-student-profile").show();
        jQuery("#nav-itm-tutor-profile").hide();
        jQuery("#nav-itm-stu-avatime").hide();
      } else {
        jQuery("#divMainContainer").load('./html/promote.html');
        jQuery("#nav-itm-student-schedule").hide();
        jQuery("#nav-itm-tutor-schedule").hide();
        jQuery("#nav-itm-rate").show();
        jQuery("#nav-itm-publishJob").hide();
        jQuery("#nav-itm-registerClass").hide();
        jQuery("#nav-itm-student-profile").hide();
        jQuery("#nav-itm-tutor-profile").hide();
        jQuery("#nav-itm-stu-avatime").hide();
      }
    }
    /*    else {
          console.log("pls check user credential");
        }
      }*/

    function logout() {
      //_gUserEmail = null;
      jQuery("#divMainContainer").load('./html/promote.html');
      jQuery("#divMainNavBar").css('display', 'none');
      jQuery("#divFirstNavBar").css('display', '');
      _gUserType = 'student';
    }
  </script>

</body>

</html>